<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rescue Intake & Quarantine Management - EWOC</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/pages/rescue-intake-management.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <div id="navbar-placeholder"></div>

    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <h1><i class="fas fa-hand-holding-medical"></i> Rescue Intake & Quarantine Workflow</h1>
            <p>Comprehensive intake queue with triage scoring, quarantine management, and medical tracking</p>
        </div>
    </header>

    <!-- Alert Dashboard -->
    <section class="alerts-section">
        <div class="container">
            <h2><i class="fas fa-bell"></i> Active Alerts</h2>
            <div class="alerts-grid" id="alertsGrid">
                <!-- Alerts will be populated dynamically -->
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-inbox"></i>
                    <h3 id="statPendingIntake">0</h3>
                    <p>Pending Intake</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-shield-virus"></i>
                    <h3 id="statInQuarantine">0</h3>
                    <p>In Quarantine</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3 id="statCritical">0</h3>
                    <p>Critical Cases</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle"></i>
                    <h3 id="statReadyRelease">0</h3>
                    <p>Ready for Release</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openIntakeModal()">
                    <i class="fas fa-plus"></i> New Intake
                </button>
                <button class="btn btn-secondary" onclick="filterIntakeQueue('all')">
                    <i class="fas fa-list"></i> All Cases
                </button>
                <button class="btn btn-secondary" onclick="filterIntakeQueue('quarantine')">
                    <i class="fas fa-shield-virus"></i> Quarantine
                </button>
                <button class="btn btn-secondary" onclick="filterIntakeQueue('critical')">
                    <i class="fas fa-exclamation-triangle"></i> Critical
                </button>
                <button class="btn btn-secondary" onclick="exportIntakeReport()">
                    <i class="fas fa-file-export"></i> Export Report
                </button>
            </div>

            <!-- Intake Queue -->
            <section class="intake-queue">
                <h2><i class="fas fa-list-ul"></i> Intake Queue</h2>
                <div class="table-responsive">
                    <table class="intake-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Date</th>
                                <th>Animal Info</th>
                                <th>Triage Score</th>
                                <th>Medical Flags</th>
                                <th>Quarantine Status</th>
                                <th>Isolation Room</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="intakeQueueBody">
                            <!-- Queue items will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </main>

    <!-- New Intake Modal -->
    <div id="intakeModal" class="modal">
        <div class="modal-content large">
            <span class="close" onclick="closeIntakeModal()">&times;</span>
            <h2><i class="fas fa-clipboard-list"></i> New Animal Intake</h2>
            
            <form id="intakeForm" onsubmit="submitIntake(event)">
                <!-- Basic Information -->
                <div class="form-section">
                    <h3>Basic Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="animalName">Animal Name/ID*</label>
                            <input type="text" id="animalName" required>
                        </div>
                        <div class="form-group">
                            <label for="species">Species*</label>
                            <select id="species" required>
                                <option value="">Select Species</option>
                                <option value="dog">Dog</option>
                                <option value="cat">Cat</option>
                                <option value="bird">Bird</option>
                                <option value="rabbit">Rabbit</option>
                                <option value="wildlife">Wildlife</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="breed">Breed</label>
                            <input type="text" id="breed">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="age">Estimated Age</label>
                            <input type="text" id="age" placeholder="e.g., 2 years, 6 months">
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="unknown">Unknown</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" step="0.1">
                        </div>
                    </div>
                </div>

                <!-- Intake Source -->
                <div class="form-section">
                    <h3>Intake Source</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="intakeSource">Source*</label>
                            <select id="intakeSource" required>
                                <option value="">Select Source</option>
                                <option value="stray">Stray/Found</option>
                                <option value="owner-surrender">Owner Surrender</option>
                                <option value="rescue">Rescue/Transfer</option>
                                <option value="cruelty-case">Cruelty Case</option>
                                <option value="wildlife-rescue">Wildlife Rescue</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="intakeLocation">Location Found</label>
                            <input type="text" id="intakeLocation">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="intakeNotes">Intake Notes</label>
                        <textarea id="intakeNotes" rows="3"></textarea>
                    </div>
                </div>

                <!-- Triage Assessment -->
                <div class="form-section">
                    <h3>Triage Assessment</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="physicalCondition">Physical Condition*</label>
                            <select id="physicalCondition" required onchange="calculateTriageScore()">
                                <option value="">Select Condition</option>
                                <option value="5">Critical - Immediate Care</option>
                                <option value="4">Severe - Urgent Care</option>
                                <option value="3">Moderate - Needs Attention</option>
                                <option value="2">Fair - Stable</option>
                                <option value="1">Good - Healthy</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="behaviorAssessment">Behavior Assessment*</label>
                            <select id="behaviorAssessment" required onchange="calculateTriageScore()">
                                <option value="">Select Behavior</option>
                                <option value="5">Aggressive/Dangerous</option>
                                <option value="4">Fearful/Stressed</option>
                                <option value="3">Anxious</option>
                                <option value="2">Calm</option>
                                <option value="1">Friendly/Social</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Triage Score</label>
                        <div class="triage-score-display" id="triageScoreDisplay">
                            <span class="score">0</span>
                            <span class="priority">Not Assessed</span>
                        </div>
                    </div>
                </div>

                <!-- Medical Flags -->
                <div class="form-section">
                    <h3>Medical Flags</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="medicalFlag" value="injury"> Injury/Trauma</label>
                        <label><input type="checkbox" name="medicalFlag" value="parasites"> Parasites</label>
                        <label><input type="checkbox" name="medicalFlag" value="malnutrition"> Malnutrition</label>
                        <label><input type="checkbox" name="medicalFlag" value="respiratory"> Respiratory Issues</label>
                        <label><input type="checkbox" name="medicalFlag" value="skin-condition"> Skin Condition</label>
                        <label><input type="checkbox" name="medicalFlag" value="infectious-disease"> Suspected Infectious Disease</label>
                        <label><input type="checkbox" name="medicalFlag" value="pregnancy"> Pregnant/Nursing</label>
                        <label><input type="checkbox" name="medicalFlag" value="chronic-condition"> Chronic Condition</label>
                    </div>
                    <div class="form-group">
                        <label for="medicalNotes">Medical Notes</label>
                        <textarea id="medicalNotes" rows="3"></textarea>
                    </div>
                </div>

                <!-- Quarantine Plan -->
                <div class="form-section">
                    <h3>Quarantine Plan</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quarantineRequired">Quarantine Required?*</label>
                            <select id="quarantineRequired" required onchange="toggleQuarantineFields()">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="form-group" id="quarantineDurationGroup">
                            <label for="quarantineDuration">Duration (days)*</label>
                            <input type="number" id="quarantineDuration" value="14">
                        </div>
                        <div class="form-group" id="isolationRoomGroup">
                            <label for="isolationRoom">Isolation Room*</label>
                            <select id="isolationRoom">
                                <option value="">Assign Room</option>
                                <option value="iso-1">Isolation Room 1</option>
                                <option value="iso-2">Isolation Room 2</option>
                                <option value="iso-3">Isolation Room 3</option>
                                <option value="iso-4">Isolation Room 4</option>
                                <option value="iso-5">Isolation Room 5</option>
                                <option value="medical-ward">Medical Ward</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Vaccination & Treatment Schedule -->
                <div class="form-section">
                    <h3>Initial Treatment Schedule</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="treatment" value="rabies-vaccine"> Rabies Vaccine</label>
                        <label><input type="checkbox" name="treatment" value="dhpp-vaccine"> DHPP Vaccine</label>
                        <label><input type="checkbox" name="treatment" value="fvrcp-vaccine"> FVRCP Vaccine</label>
                        <label><input type="checkbox" name="treatment" value="deworming"> Deworming</label>
                        <label><input type="checkbox" name="treatment" value="flea-tick"> Flea/Tick Treatment</label>
                        <label><input type="checkbox" name="treatment" value="microchip"> Microchipping</label>
                    </div>
                </div>

                <!-- Paperwork Upload -->
                <div class="form-section">
                    <h3>Paperwork Upload</h3>
                    <div class="form-group">
                        <label for="intakePaperwork">Intake Documents</label>
                        <input type="file" id="intakePaperwork" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                        <small>Upload intake forms, owner surrender papers, medical records, etc.</small>
                    </div>
                </div>

                <!-- Vet Appointment -->
                <div class="form-section">
                    <h3>Initial Vet Appointment</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="vetAppointmentDate">Appointment Date*</label>
                            <input type="date" id="vetAppointmentDate" required>
                        </div>
                        <div class="form-group">
                            <label for="vetAppointmentTime">Time*</label>
                            <input type="time" id="vetAppointmentTime" required>
                        </div>
                        <div class="form-group">
                            <label for="vetClinic">Vet Clinic</label>
                            <select id="vetClinic">
                                <option value="">Select Clinic</option>
                                <option value="in-house">In-House Vet</option>
                                <option value="emergency">Emergency Vet</option>
                                <option value="partner-clinic-1">Partner Clinic 1</option>
                                <option value="partner-clinic-2">Partner Clinic 2</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Intake Cost Estimate -->
                <div class="form-section">
                    <h3>Initial Cost Estimate</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicalCost">Medical Care ($)</label>
                            <input type="number" id="medicalCost" step="0.01" value="0">
                        </div>
                        <div class="form-group">
                            <label for="quarantineCost">Quarantine Care ($)</label>
                            <input type="number" id="quarantineCost" step="0.01" value="0">
                        </div>
                        <div class="form-group">
                            <label for="suppliesCost">Supplies ($)</label>
                            <input type="number" id="suppliesCost" step="0.01" value="0">
                        </div>
                    </div>
                    <div class="cost-total">
                        <strong>Total Estimated Cost: $<span id="totalCost">0.00</span></strong>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeIntakeModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Submit Intake</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Animal Details Modal -->
    <div id="animalDetailsModal" class="modal">
        <div class="modal-content large">
            <span class="close" onclick="closeAnimalDetailsModal()">&times;</span>
            <div id="animalDetailsContent">
                <!-- Details will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="../js/global/navbar.js"></script>
    <script src="../js/global/footer.js"></script>
    <script src="../js/pages/rescue-intake-management.js"></script>
</body>
</html>
